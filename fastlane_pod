#!/bin/bash

# è®¡æ—¶
SECONDS=0
# è·å–å·¥ç¨‹æ ¹ç›®å½•

fadir()  
{  
    local this_dir=`pwd`  
    local child_dir="$1" 
    dirname "$child_dir" 
    cd $this_dir  
} 
CUR_DIR=$(cd `dirname $0` && pwd -P ) 
echo "å½“å‰æ–‡ä»¶è·¯å¾„ $CUR_DIR"
cd $CUR_DIR

echo "
ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  "
echo "
è¯·é€‰æ‹©è¦å‘å¸ƒçš„podspecåºå·:"

echo "
(0) é€€å‡º
"

#æŸ¥æ‰¾æ–‡ä»¶
  a=1
  list=`find . -type f -name "*.podspec"`
  for i in $list  
    do  
    echo "($a) $i
    "  
    array[$a]=$i
    a=$(($a+1)) 
  done  
echo "
ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  "
read input

case $input in
  
    [1-9])
# å¤„ç†æ–‡ä»¶å 
	name1=${array[$input]} 
   # echo "111$name1"
# æˆªå–æ‰/å·¦è¾¹çš„
	name2=${name1#*/}
    # echo "222$name2"
# æˆªå–æ‰ã€‚åè¾¹çš„
	podspec=${name2%.*}
    # echo "333$podspec"

echo "
ğŸš€ å·²ç»é€‰æ‹©ä»“åº“åç§°ä¸ºï¼š$podspec"

    read -p "
    ğŸš€ è¯·è¾“å…¥ç‰ˆæœ¬å·: " user_tags

    echo "
    ğŸš€ ç‰ˆæœ¬å·: V $user_tags "


    read -p "
    ğŸš€ è¯·è¾“å…¥æ›´æ–°å†…å®¹ï¼ˆæ³¨æ„ä¸è¦ç”¨ç©ºæ ¼ï¼‰: " update_message

    echo "
    ğŸš€ æ›´æ–°å†…å®¹: $update_message "

    ;; 
    0)
    exit 
esac


echo "
ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰"

echo "
æ˜¯å¦å‘å¸ƒpodåˆ°ç§æœ‰ä»“åº“ï¼Ÿ:"

echo "
(0) ä¸æ˜¯
"
#æŸ¥æ‰¾æ–‡ä»¶
  b=1
  listRepo=`ls ~/.cocoapods/repos`
  for i in $listRepo  
    do  
    echo "($b) $i
    "  
    arrayRepo[$b]=$i
    b=$(($b+1)) 
  done  
echo "ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰  ğŸ‰ 
 "
read input

case $input in
  
    [1-99])

     repo=${arrayRepo[$input]} 
echo "
ğŸš€ å·²ç»é€‰æ‹©Repoåç§°ä¸ºï¼š$repo
"

echo "
ğŸš€ å³å°†å‘å¸ƒ V $user_tags ç‰ˆæœ¬çš„ $podspec åˆ° $repo, æ›´æ–°: $update_message 
"
    fastlane release_pod t:$user_tags p:$podspec r:$repo m:$update_message
    ;; 

    0)

echo "
ğŸš€ å³å°†å‘å¸ƒ V $user_tags ç‰ˆæœ¬çš„ $podspec, æ›´æ–°: $update_message 
"
    fastlane release_pod t:$user_tags p:$podspec m:$update_message
    ;;
esac

echo "ğŸš€ æ€»ç”¨æ—¶: ${SECONDS}s"
exit
 

